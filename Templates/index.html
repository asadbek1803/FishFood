{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/index.css' %}">
{% endblock %}

{% block content %}
<!-- Hero Slider with Neon Effects -->
<section class="hero-section">
    <div class="hero-slider" id="heroSlider">
        {% for slide in sliders %}
        <div class="hero-slide {% if forloop.first %}active{% endif %}" data-slide="{{ forloop.counter0 }}">
            <div class="slide-background">
                {% if slide.slider_type == 'video' %}
                    {% if slide.video %}
                        <video autoplay muted loop playsinline>
                            <source src="{{ slide.video.url }}" type="video/mp4">
                        </video>
                    {% elif slide.video_url %}
                        <iframe src="{{ slide.video_url }}?autoplay=1&mute=1&loop=1&controls=0" frameborder="0" allow="autoplay; encrypted-media"></iframe>
                    {% endif %}
                {% else %}
                    {% if slide.image %}
                        <img src="{{ slide.image.url }}" alt="{{ slide.title }}" loading="lazy">
                    {% else %}
                        <img src="{% static 'images/default-hero.jpg' %}" alt="Hero" loading="lazy">
                    {% endif %}
                {% endif %}
            </div>
            <div class="slide-overlay"></div>
            <div class="slide-content">
                <div class="neon-text">
                    <h1 class="neon-title">{{ slide.title }}</h1>
                </div>
                {% if slide.description %}
                <p class="slide-description">{{ slide.description }}</p>
                {% endif %}
                <a href="{{ slide.button_url|default:'#' }}" class="btn-neon btn-slide">
                    <span>{{ slide.button_text|default:"Batafsil" }}</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
        {% empty %}
        <div class="hero-slide active">
            <div class="slide-background">
                <img src="{% static 'images/default-hero.jpg' %}" alt="FishFood" loading="lazy">
            </div>
            <div class="slide-overlay"></div>
            <div class="slide-content">
                <div class="neon-text">
                    <h1 class="neon-title">Premium Sea Food</h1>
                </div>
                <p class="slide-description">Eng sifatli dengiz mahsulotlari, to'g'ridan-to'g'ri dengizdan.</p>
                <a href="{% url 'shop' %}" class="btn-neon btn-slide">
                    <span>Buyurtma Berish</span>
                    <i class="fas fa-shopping-cart"></i>
                </a>
            </div>
        </div>
        {% endfor %}
    </div>
    
    <div class="slider-controls">
        <div class="slider-dots" id="sliderDots"></div>
        <div class="slider-arrows">
            <button class="slider-arrow prev" id="prevSlide" aria-label="Oldingi" type="button">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="slider-arrow next" id="nextSlide" aria-label="Keyingi" type="button">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
</section>

<!-- Services Section -->
<section class="section services-section" id="services">
    <div class="container">
        <h2 class="section-title">
            <span class="title-text">Bizning Xizmatlar</span>
            <span class="title-line"></span>
        </h2>
        <div class="services-grid">
            {% for service in services %}
            <div class="service-card">
                <div class="service-icon">
                    <i class="{{ service.icon }}"></i>
                </div>
                <h3>{{ service.title }}</h3>
                <p>{{ service.description }}</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- Popular Products Section -->
<section class="section products-section" id="products">
    <div class="container">
        <h2 class="section-title">
            <span class="title-text">Ommabop Mahsulotlar</span>
            <span class="title-line"></span>
        </h2>
        <div class="products-grid">
            {% for product in public_products %}
            <div class="product-card">
                <div class="product-image">
                    {% if product.image %}
                        <img src="{{ product.image.url }}" alt="{{ product.name }}" loading="lazy">
                    {% else %}
                        <div class="product-placeholder">
                            <i class="fas fa-fish"></i>
                        </div>
                    {% endif %}
                </div>
                <div class="product-info">
                    <h3>{{ product.name }}</h3>
                    <div class="product-price">{{ product.price|floatformat:0 }} so'm / kg</div>
                    <button class="btn-add-cart" data-id="{{ product.id }}" data-name="{{ product.name }}" data-price="{{ product.price }}" type="button">
                        <i class="fas fa-cart-plus"></i>
                        <span>Savatga qo'shish</span>
                    </button>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="section-footer">
            <a href="{% url 'shop' %}" class="btn-neon">
                <span>Barcha mahsulotlar</span>
                <i class="fas fa-arrow-right"></i>
            </a>
        </div>
    </div>
</section>

<!-- Testimonials Section -->
<section class="section testimonials-section" id="testimonials">
    <div class="container">
        <h2 class="section-title">
            <span class="title-text">Mijozlarimiz Fikrlari</span>
            <span class="title-line"></span>
        </h2>
        <div class="testimonials-grid">
            {% for testimonial in testimonials %}
            <div class="testimonial-card">
                <div class="testimonial-rating">
                    {% for i in "12345" %}
                        {% if forloop.counter <= testimonial.rate %}
                            <i class="fas fa-star"></i>
                        {% else %}
                            <i class="far fa-star"></i>
                        {% endif %}
                    {% endfor %}
                </div>
                <p class="testimonial-text">"{{ testimonial.feedback }}"</p>
                <div class="testimonial-author">
                    <h4>{{ testimonial.full_name }}</h4>
                    <span>{{ testimonial.region }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}

